# Прогнозирование оттока партнеров

## Описание проекта

Данный проект посвящен прогнозированию оттока партнеров на основе данных из датасета. Мы используем библиотеку CatBoost для построения модели классификации и предсказания вероятности оттока партнеров. Данные были разделены на тренировочные, тестовые и целевые наборы для обучения модели и оценки её производительности.

## Структура проекта

- `ACJ_ML_Финал_Putin_Team_Russia.ipynb` - файл с самой моделью
- `final_submission_unique.csv` - файл с финальными предсказаниями
- `README.md` - описание проекта

## Установка

Для запуска проекта вам понадобятся следующие библиотеки:

- pandas
- numpy
- scikit-learn
- catboost

Вы можете установить их с помощью pip:

```bash
pip install pandas numpy scikit-learn catboost
```


## Техническая реализация

1. **Загрузка данных:**
    - Данные загружаются из CSV файла в DataFrame с использованием библиотеки pandas.

2. **Предобработка данных:**
    - Преобразование столбцов с датами в формат datetime.
    - Определение контрольных дат для разделения данных.
    - Фильтрация данных по заданным временным интервалам для создания тренировочного, тестового и целевого наборов данных.
    - Агрегирование данных по клиентам с использованием группировки и расчета различных метрик.

3. **Фильтрация и создание новых признаков:**
    - Удаление строк с количеством привлеченных клиентов выше определенного порогового значения.
    - Подсчет недавних и старых привлеченных клиентов.
    - Добавление новых столбцов с вычисляемыми значениями, такими как количество месяцев с последнего клиента, среднее время между появлениями клиентов и т.д.

4. **Стандартизация данных:**
    - Стандартизация числовых признаков с использованием StandardScaler.

5. **Обучение модели:**
    - Создание и настройка модели CatBoostClassifier с использованием различных гиперпараметров и весов классов для борьбы с несбалансированными данными.
    - Обучение модели на тренировочных данных.

6. **Оценка модели:**
    - Предсказание вероятностей на тестовых данных и расчет метрики ROC-AUC для оценки производительности модели.

7. **Предсказание на целевых данных:**
    - Получение прогнозов для целевых данных и создание финального файла с предсказаниями в формате CSV.

## Результаты

В ходе выполнения проекта мы получили прогнозы вероятности оттока партнеров, которые можно использовать для принятия бизнес-решений. Метрика ROC-AUC для модели CatBoost составила 0.758, что свидетельствует о качестве модели.

## Описание фич

- `days_since_last_client`: Количество дней с момента последнего привлеченного клиента.
- `days_since_partner_start`: Количество дней с момента начала партнерства.
- `num_clients`: Общее количество клиентов.
- `num_recent_clients`: Количество недавно привлеченных клиентов (за последний месяц).
- `avg_time_between_clients`: Среднее время (в днях) между привлечением клиентов.
- `time_as_partner`: Общее время (в днях) в качестве партнера.
- `partner_src_type_ccode`: Код типа партнера -- категориальный признак.
- `num_other_clients`: Количество клиентов, привлеченных более месяца назад.
